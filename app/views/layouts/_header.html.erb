<header class="relative text-center mb-4 mt-4 leading-relaxed">
  <div class="max-w-5xl mx-auto px-4">
    <h1 class="text-5xl text-white bg-transparent leading-tight font-work-sans">
      <span
        id="example-link"
        role="button"
        class="hover:underline cursor-pointer bg-transparent border-0 text-white text-5xl"
        data-action="click->regexp-examples#selectExample"
        data-pattern=""
        data-test=""
        data-options=""
        data-substitution="">
        Rubree
      </span>
    </h1>

    <div class="flex flex-col sm:flex-row items-center justify-center gap-0">
      <p class="text-gray-400 text-lg sm:mr-1"><%= t("regular_expressions.header.subtitle", default: "a Ruby regular expression editor") %></p>

      <!-- Try + Dice: stacked margin on small, no margin on sm+ (single-line) -->
      <div class="mt-1 sm:mt-0 inline-flex items-center gap-0">
        <span id="example-link"
          role="button"
          class="text-blue-400 text-lg hover:underline cursor-pointer bg-transparent px-1 rounded"
          data-action="click->regexp-examples#selectExample"
          data-pattern="(?<month>\d{1,2})\/(?<day>\d{1,2})\/(?<year>\d{4})"
          data-test="Today's date is: <%= Time.now.strftime("%-m/%-d/%Y") %>."
          data-options=""
          data-substitution="\k<year>/\k<month>/\k<day>"
          data-no-last-selected="true">
          <%= t("regular_expressions.header.try_example", default: "Try an example") %>
        </span>

        <button type="button"
          class="text-sm text-gray-300 hover:text-white bg-transparent px-1 rounded transition transform hover:scale-110 duration-200 dice-link relative"
          data-action="click->regexp-examples#tryExample"
          data-regexp-examples-target="diceButton"
          aria-label="<%= t("regular_expressions.header.try_random", default: "Try a random example") %>">
          ðŸŽ²
          <span class="dice-tooltip" role="tooltip"><%= t("regular_expressions.header.try_random_tooltip", default: "Try a random example") %></span>
        </button>
      </div>
    </div>
  </div>

  <!-- Dropdown: kept outside of inline flow so it cannot affect header layout. Controller will portal/position it on open. -->
  <div data-regexp-examples-target="headerDropdown" class="hidden z-50 sm:w-96 w-full max-w-full sm:max-w-sm" role="menu" aria-label="<%= t("regular_expressions.header.examples", default: "Examples") %>">
    <div class="bg-gradient-to-b from-slate-900 to-gray-800 text-gray-100 border border-gray-700 rounded-lg shadow-2xl overflow-hidden ring-1 ring-black/40">
        <!-- Two-column: left = categories, right = items for selected category -->
        <div class="px-2 py-1">
          <div class="flex gap-2">
            <!-- categories column (independent scroll) -->
            <div data-regexp-examples-target="headerScroll" class="w-1/3 border-r border-gray-700 pr-1 max-h-80 overflow-auto">
              <% regexp_example_categories.each_with_index do |(cat, data), i| %>
                <button type="button"
                  class="w-full text-left text-sm text-gray-300 py-1 px-1 hover:bg-gray-700 focus:outline-none transition-colors"
                  data-header-category="<%= cat.to_s.parameterize %>"
                  data-action="click->regexp-examples#showCategory click->regexp-examples#showHeaderCategory">
                  <div class="font-medium"><%= data[:short] %></div>
                  <div class="text-xs text-gray-400"><%= cat.to_s.humanize %></div>
                </button>
              <% end %>
            </div>

            <!-- items column -->
              <div data-regexp-examples-target="headerItemsScroll" class="w-2/3 max-h-80 overflow-auto pl-2">
              <% regexp_example_categories.each_with_index do |(cat, data), i| %>
                <div data-header-category-content="<%= cat.to_s.parameterize %>" class="<%= i.zero? ? "" : "hidden" %>">
                  <div class="mt-0 space-y-1">
                    <% data[:examples].each do |ex| %>
                      <button type="button"
                        class="w-full text-left px-2 py-1 hover:bg-gray-700 focus:outline-none transition-colors"
                        data-regexp-examples-target="example"
                        data-action="click->regexp-examples#selectExample"
                        data-pattern="<%= ex[:pattern].gsub("\"", "&quot;") %>"
                        data-test="<%= ex[:test].gsub("\"", "&quot;") %>"
                        data-substitution="<%= ex[:substitution] || "" %>"
                        data-options="<%= ex[:options] || "" %>">
                        <div class="text-sm text-gray-100 leading-snug"><%= (ex[:description].presence || ex[:test]).truncate(100) %></div>
                        <div class="text-xs text-gray-300 mt-0 truncate"><%= ex[:pattern].truncate(80) %> â€” <%= ex[:test].truncate(80) %></div>
                      </button>
                    <% end %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
    </div>
  </div>

  <%= render "layouts/header_controls" %>
</header>
