<!-- app/views/regular_expressions/_result.html.erb -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-8 bg-gray-900 rounded-lg shadow-lg p-4 mb-4 border border-gray-700">
  <%= render partial: "regular_expressions/results/diagram", locals: { regular_expression: regular_expression } %>

  <div
    x-data="{
      wrap: localStorage.getItem('wrap') === 'false' ? false : true,
      showInvisibles: localStorage.getItem('showInvisibles') === 'true',
      init() {
        this.$watch('wrap', value => localStorage.setItem('wrap', value));
        this.$watch('showInvisibles', value => localStorage.setItem('showInvisibles', value));
      }
    }"
    class="flex flex-col space-y-2 overflow-auto rounded border border-gray-700 bg-gray-900 p-4 min-h-[140px] text-white text-left">
    <% if regular_expression.expression.blank? && regular_expression.test_string.blank? %>
      <p class="text-gray-500 m-auto text-center">Regexp test result will appear here</p>

    <% elsif regular_expression.unready? %>
      <p class="text-gray-400 text-sm">Please enter a regex pattern and a test string.</p>

    <% elsif !regular_expression.valid? %>
      <label class="text-sm font-bold text-white">Match result:</label>
      <div class="bg-red-100 border-4 border-double border-red-600 text-red-800 p-4 rounded-md font-semibold whitespace-pre-wrap mb-2">Invalid regular expression.</div>

    <% elsif regular_expression.match_success %>
      <%= render "regular_expressions/results/match", regular_expression: regular_expression %>

      <% if regular_expression.display_captures.any? { |group| group.present? && group.any?(&:present?) } %>
        <%= render "regular_expressions/results/captures", regular_expression: regular_expression %>
      <% end %>

      <% if regular_expression.substitution_result.present? %>
        <%= render "regular_expressions/results/substitution", regular_expression: regular_expression %>
      <% end %>

      <% if regular_expression.ruby_code_snippet.present? %>
        <%= render "regular_expressions/results/ruby_code", regular_expression: regular_expression %>
      <% end %>

    <% else %>
      <label class="text-sm font-bold text-white">Match result:</label>
      <div class="bg-red-100 border-4 border-double border-red-600 text-red-800 p-4 rounded-md font-semibold whitespace-pre-wrap mb-2">No matches.</div>
    <% end %>
  </div>
</div>
